{"version":3,"file":"zod.js","sources":["../src/zod.ts"],"sourcesContent":["import {\n  appendErrors,\n  Resolver,\n  ResolverError,\n  ResolverSuccess,\n  transformToNestObject,\n} from 'react-hook-form';\nimport * as z from 'zod';\nimport { ParseParams } from 'zod/lib/src/parser';\n// @ts-expect-error maybe fixed after the first publish ?\nimport { convertArrayToPathName } from '@hookform/resolvers';\n\nconst parseErrorSchema = (\n  zodError: z.ZodError,\n  validateAllFieldCriteria: boolean,\n) => {\n  if (zodError.isEmpty) {\n    return {};\n  }\n\n  return zodError.errors.reduce<Record<string, any>>(\n    (previous, { path, message, code: type }) => {\n      const currentPath = convertArrayToPathName(path);\n\n      return {\n        ...previous,\n        ...(path\n          ? previous[currentPath] && validateAllFieldCriteria\n            ? {\n                [currentPath]: appendErrors(\n                  currentPath,\n                  validateAllFieldCriteria,\n                  previous,\n                  type,\n                  message,\n                ),\n              }\n            : {\n                [currentPath]: previous[currentPath] || {\n                  message,\n                  type,\n                  ...(validateAllFieldCriteria\n                    ? {\n                        types: { [type]: message || true },\n                      }\n                    : {}),\n                },\n              }\n          : {}),\n      };\n    },\n    {},\n  );\n};\n\nexport const zodResolver = <T extends z.ZodSchema<any, any>>(\n  schema: T,\n  options?: ParseParams,\n): Resolver<z.infer<T>> => async (\n  values,\n  _,\n  validateAllFieldCriteria = false,\n) => {\n  const result = schema.safeParse(values, options);\n\n  if (result.success) {\n    return { values: result.data, errors: {} } as ResolverSuccess<z.infer<T>>;\n  }\n\n  return {\n    values: {},\n    errors: transformToNestObject(\n      parseErrorSchema(result.error, validateAllFieldCriteria),\n    ),\n  } as ResolverError<z.infer<T>>;\n};\n"],"names":["parseErrorSchema","zodError","validateAllFieldCriteria","isEmpty","errors","reduce","previous","path","message","type","code","currentPath","convertArrayToPathName","appendErrors","types","schema","options","values","_","result","safeParse","success","data","transformToNestObject","error"],"mappings":"iRAYA,IAAMA,EAAmB,SACvBC,EACAC,GAEA,OAAID,EAASE,QACJ,GAGFF,EAASG,OAAOC,OACrB,SAACC,eAAYC,IAAAA,KAAMC,IAAAA,QAAeC,IAANC,KACpBC,EAAcC,yBAAuBL,GAE3C,YACKD,EACCC,EACAD,EAASK,IAAgBT,UAEpBS,GAAcE,eACbF,EACAT,EACAI,EACAG,EACAD,cAIDG,GAAcL,EAASK,OACtBH,QAAAA,EACAC,KAAAA,GACIP,EACA,CACEY,cAAUL,GAAOD,IAAW,MAE9B,OAGV,KAGR,yBAIuB,SACzBO,EACAC,mBAEAC,EACAC,EACAhB,YAAAA,IAAAA,GAA2B,OAE3B,IAAMiB,EAASJ,EAAOK,UAAUH,EAAQD,GAExC,uBAAIG,EAAOE,QACF,CAAEJ,OAAQE,EAAOG,KAAMlB,OAAQ,IAGjC,CACLa,OAAQ,GACRb,OAAQmB,wBACNvB,EAAiBmB,EAAOK,MAAOtB,MAjBV"}