"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var icons_1 = require("@sanity/icons");
var ui_1 = require("@sanity/ui");
var react_1 = __importDefault(require("react"));
var react_redux_1 = require("react-redux");
var react_select_1 = __importDefault(require("react-select"));
var searchFacets_1 = require("../../config/searchFacets");
var useTypedSelector_1 = __importDefault(require("../../hooks/useTypedSelector"));
var search_1 = require("../../modules/search");
var tags_1 = require("../../modules/tags");
var single_1 = require("../../styled/react-select/single");
var getTagSelectOptions_1 = __importDefault(require("../../utils/getTagSelectOptions"));
var SearchFacet_1 = __importDefault(require("../SearchFacet"));
var SearchFacetTags = function (props) {
    var facet = props.facet;
    // Redux
    var dispatch = react_redux_1.useDispatch();
    var tags = useTypedSelector_1.default(function (state) { return tags_1.selectTags(state); });
    var tagsFetching = useTypedSelector_1.default(function (state) { return state.tags.fetching; });
    var allTagOptions = getTagSelectOptions_1.default(tags);
    var handleChange = function (option) {
        dispatch(search_1.searchActions.facetsUpdate({
            name: facet.name,
            value: option
        }));
    };
    var handleOperatorItemClick = function (operatorType) {
        dispatch(search_1.searchActions.facetsUpdate({
            name: facet.name,
            operatorType: operatorType
        }));
    };
    var selectedOperatorType = facet.operatorType;
    return (react_1.default.createElement(SearchFacet_1.default, { facet: facet },
        (facet === null || facet === void 0 ? void 0 : facet.operatorTypes) && (react_1.default.createElement(ui_1.MenuButton, { button: react_1.default.createElement(ui_1.Button, { fontSize: 1, iconRight: icons_1.SelectIcon, padding: 2, text: searchFacets_1.operators[selectedOperatorType].label }), id: "operators", menu: react_1.default.createElement(ui_1.Menu, null, facet.operatorTypes.map(function (operatorType, index) {
                if (operatorType) {
                    return (react_1.default.createElement(ui_1.MenuItem, { disabled: operatorType === selectedOperatorType, fontSize: 1, key: operatorType, onClick: function () { return handleOperatorItemClick(operatorType); }, padding: 2, text: searchFacets_1.operators[operatorType].label }));
                }
                return react_1.default.createElement(ui_1.MenuDivider, { key: index });
            })) })),
        !searchFacets_1.operators[selectedOperatorType].hideInput && (react_1.default.createElement(ui_1.Box, { marginX: 1, style: { width: '160px' } },
            react_1.default.createElement(react_select_1.default, { components: single_1.reactSelectComponents, instanceId: "facet-searchable", isClearable: true, isDisabled: tagsFetching, isSearchable: true, name: "tags", noOptionsMessage: function () { return 'No tags'; }, onChange: function (value) { return handleChange(value); }, options: allTagOptions, placeholder: tagsFetching ? 'Loading...' : 'Select...', styles: single_1.reactSelectStyles, value: facet === null || facet === void 0 ? void 0 : facet.value })))));
};
exports.default = SearchFacetTags;
//# sourceMappingURL=index.js.map